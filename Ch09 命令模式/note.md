# 命令模式

## 定义

命令模式中的命令，指的是一个执行某些特定事情的指令。

应用场景：有时候要向某些对象发送请求，但是并不知道请求的接受者是谁，也不知道被请求的操作是什么。
此时希望用一种松耦合的方式来设计程序，使得发送者和请求接收者能够清除彼此之间的耦合关系。

## 传统实现

对于静态类型语言（不可传递函数的），无法使用 callback 。
一般某个对象（发送者）要调用另一个对象（接收者）的方法，必须明确目标对象的类型，这就形成了耦合。
如何在不了解接收者的情况下调用它的方法，就是命令模式要解决的问题。

命令模式规定了一个命令类，所有的发送者都了解这个命令类，知道它的结构和方法（execute）。
我们通过 setCommand 函数将命令类的方法和接受者的方法挂接在一起，这就形成了执行特定任务的 command。
之后再将command传送给发送者即可。由此实现了发送者和接受者的解耦。

在此基础上，由于命令像一个中介者一样将发送者和接受者连接起来，它实际可以完成更多的任务。
比如，在执行动作之前，记录接受者的状态，这就可以实现 undo；
执行动作之前，同时状态和动作的参数，就可以在 undo 后执行redo；等等。

## Javascript中的实现

在JS这种动态类型语言中，由于不做类型检查，且支持函数传递，所以我们可以用 callback 轻松实现方法的挂接。

但是，如果我们想获得命令模式带来的其他好处（undo，redo），就还是需要在两者之间实现一个中介者，完成状态和指令的记录。

## 我的理解

命令模式，就是在接受者上接了一个外壳，对外提供标准调用接口，同时提供 undo redo 等附加服务。
在JS中，如果需要 undo 和 redo 的时候，才有必要考虑命令模式，否则直接 callback 就足够了。
